<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/433/433424.png" type="faw-icon">
    <title>Mening Kassam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body
    class="text-slate-100 h-screen flex flex-col overflow-hidden max-w-md mx-auto border-x border-slate-800 shadow-2xl relative">

    <div id="pin-screen" class="fixed inset-0 z-[100] bg-slate-900 flex flex-col items-center justify-center hidden">
        <div class="mb-8 text-center fade-in">
            <div
                class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-blue-500/30">
                <i data-lucide="lock" class="w-8 h-8 text-white"></i>
            </div>
            <h2 id="pin-title" class="text-2xl font-bold text-white mb-1">PIN Kod</h2>
            <p id="pin-subtitle" class="text-slate-400 text-sm">Kirish uchun</p>
        </div>
        <div class="flex gap-4 mb-8 fade-in" id="pin-dots">
            <div class="pin-dot w-4 h-4 rounded-full bg-slate-700"></div>
            <div class="pin-dot w-4 h-4 rounded-full bg-slate-700"></div>
            <div class="pin-dot w-4 h-4 rounded-full bg-slate-700"></div>
            <div class="pin-dot w-4 h-4 rounded-full bg-slate-700"></div>
        </div>
        <div class="grid grid-cols-3 gap-6 fade-in mb-6">
            <button onclick="handlePinInput(1)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">1</button>
            <button onclick="handlePinInput(2)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">2</button>
            <button onclick="handlePinInput(3)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">3</button>
            <button onclick="handlePinInput(4)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">4</button>
            <button onclick="handlePinInput(5)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">5</button>
            <button onclick="handlePinInput(6)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">6</button>
            <button onclick="handlePinInput(7)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">7</button>
            <button onclick="handlePinInput(8)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">8</button>
            <button onclick="handlePinInput(9)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">9</button>
            <button onclick="triggerBiometric()" id="bio-btn"
                class="w-16 h-16 rounded-full bg-transparent text-blue-500 flex items-center justify-center hover:bg-slate-800/50 hidden"><i
                    data-lucide="scan-face" class="w-8 h-8"></i></button>
            <div id="bio-placeholder" class="w-16 h-16 hidden"></div>
            <button onclick="handlePinInput(0)"
                class="w-16 h-16 rounded-full bg-slate-800 text-2xl font-medium text-white hover:bg-slate-700 transition-colors">0</button>
            <button onclick="handlePinDelete()"
                class="w-16 h-16 rounded-full bg-transparent text-white hover:bg-slate-800/50 transition-colors flex items-center justify-center"><i
                    data-lucide="delete" class="w-8 h-8"></i></button>
        </div>
        <button id="cancel-pin-setup" onclick="cancelPinSetup()"
            class="text-slate-400 text-sm hover:text-white hidden">Bekor qilish</button>
    </div>

    <header class="glass-panel rounded-2xl m-2 p-4 flex items-center justify-between z-20 sticky top-2 shadow-lg">
        <div class="flex items-center gap-3">
            <div class="relative">
                <img src="https://ui-avatars.com/api/?name=User&background=3b82f6&color=fff"
                    class="w-10 h-10 rounded-full border-2 border-blue-500 object-cover">
                <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-slate-800 rounded-full">
                </div>
            </div>
            <div>
                <div class="text-xs text-slate-400">Assalomu alaykum!</div>
                <div class="font-bold text-sm">Xush kelibsiz üëã</div>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleTheme()" class="p-2 rounded-full hover:bg-slate-700/20"><i id="theme-icon"
                    data-lucide="moon" class="w-5 h-5"></i></button>
            <button onclick="openSettings()" class="p-2 bg-slate-700 hover:bg-slate-600 rounded-full text-slate-200"><i
                    data-lucide="settings" class="w-5 h-5"></i></button>
        </div>
    </header>
    <main id="main-container"
        class="flex-1 overflow-y-auto relative bg-slate-900 rounded-t-3xl mt-2 pb-24 px-4 pt-6 scroll-smooth">
        <div id="dashboard-skeleton" class="space-y-6 pt-2">
            <div class="skeleton-box h-48 w-full rounded-3xl relative overflow-hidden border border-slate-700/50">
                <div class="absolute top-6 left-6 w-24 h-4 bg-slate-700/50 rounded skeleton-box"></div>
                <div class="absolute top-12 left-6 w-40 h-10 bg-slate-700/50 rounded skeleton-box"></div>
                <div class="absolute bottom-6 left-6 right-6 flex gap-3">
                    <div class="h-16 flex-1 rounded-2xl bg-slate-700/50 skeleton-box"></div>
                    <div class="h-16 flex-1 rounded-2xl bg-slate-700/50 skeleton-box"></div>
                </div>
            </div>

            <div class="flex gap-2 overflow-x-hidden">
                <div class="w-20 h-8 rounded-full bg-slate-800 skeleton-box"></div>
                <div class="w-16 h-8 rounded-full bg-slate-800 skeleton-box"></div>
                <div class="w-16 h-8 rounded-full bg-slate-800 skeleton-box"></div>
                <div class="w-20 h-8 rounded-full bg-slate-800 skeleton-box"></div>
            </div>

            <div class="p-5 rounded-3xl border border-slate-700/30 bg-slate-800/50">
                <div class="w-32 h-4 mb-4 rounded bg-slate-700/50 skeleton-box"></div>
                <div class="h-40 w-40 mx-auto rounded-full bg-slate-700/50 skeleton-box border-4 border-slate-800">
                </div>
            </div>

            <div class="space-y-3">
                <div class="w-32 h-4 rounded bg-slate-700/50 skeleton-box mb-4"></div>
                <div
                    class="h-20 w-full rounded-2xl bg-slate-800/50 p-4 flex items-center justify-between border border-slate-700/30">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-slate-700/50 skeleton-box"></div>
                        <div class="space-y-2">
                            <div class="w-24 h-4 rounded bg-slate-700/50 skeleton-box"></div>
                            <div class="w-16 h-3 rounded bg-slate-700/50 skeleton-box"></div>
                        </div>
                    </div>
                    <div class="w-20 h-5 rounded bg-slate-700/50 skeleton-box"></div>
                </div>
                <div
                    class="h-20 w-full rounded-2xl bg-slate-800/50 p-4 flex items-center justify-between border border-slate-700/30">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-slate-700/50 skeleton-box"></div>
                        <div class="space-y-2">
                            <div class="w-24 h-4 rounded bg-slate-700/50 skeleton-box"></div>
                            <div class="w-16 h-3 rounded bg-slate-700/50 skeleton-box"></div>
                        </div>
                    </div>
                    <div class="w-20 h-5 rounded bg-slate-700/50 skeleton-box"></div>
                </div>
                <div
                    class="h-20 w-full rounded-2xl bg-slate-800/50 p-4 flex items-center justify-between border border-slate-700/30">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-slate-700/50 skeleton-box"></div>
                        <div class="space-y-2">
                            <div class="w-24 h-4 rounded bg-slate-700/50 skeleton-box"></div>
                            <div class="w-16 h-3 rounded bg-slate-700/50 skeleton-box"></div>
                        </div>
                    </div>
                    <div class="w-20 h-5 rounded bg-slate-700/50 skeleton-box"></div>
                </div>
            </div>
        </div>
        <div id="view-dashboard" class="space-y-6 fade-in hidden">
            <div
                class="bg-gradient-to-br from-slate-800 to-slate-900 p-6 rounded-3xl shadow-lg border border-slate-700 relative overflow-hidden">
                <div class="absolute -top-6 -right-6 opacity-10 rotate-12"><i data-lucide="wallet"
                        class="w-40 h-40 text-white"></i></div>
                <h2 class="text-slate-400 text-xs font-bold uppercase tracking-wider mb-1">Umumiy Balans</h2>
                <div id="total-balance" class="text-3xl font-bold text-[#2374f8] mb-6 font-mono">0 so'm</div>
                <div class="grid grid-cols-2 gap-3 relative z-10">
                    <div onclick="toggleTypeFilter('income')" id="card-income"
                        class="glass-panel p-3 rounded-2xl flex items-center gap-3 cursor-pointer transition-all hover:bg-emerald-500/10">
                        <div class="p-2 bg-emerald-500 rounded-full text-white shadow-lg shadow-emerald-500/30"><i
                                data-lucide="arrow-down-left" class="w-4 h-4"></i></div>
                        <div class="overflow-hidden">
                            <div class="text-[10px] text-slate-400 uppercase">Kirim</div>
                            <div id="total-income" class="font-bold text-emerald-400 text-sm truncate">0</div>
                        </div>
                    </div>
                    <div onclick="toggleTypeFilter('expense')" id="card-expense"
                        class="glass-panel p-3 rounded-2xl flex items-center gap-3 cursor-pointer transition-all hover:bg-rose-500/10">
                        <div class="p-2 bg-rose-500 rounded-full text-white shadow-lg shadow-rose-500/30"><i
                                data-lucide="arrow-up-right" class="w-4 h-4"></i></div>
                        <div class="overflow-hidden">
                            <div class="text-[10px] text-slate-400 uppercase">Chiqim</div>
                            <div id="total-expense" class="font-bold text-rose-400 text-sm truncate">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex gap-2 overflow-x-auto pb-1 no-scrollbar">
                <button data-filter="all" onclick="setDateFilter('all')"
                    class="date-filter-btn bg-slate-800 border border-slate-700 text-slate-300 text-xs px-4 py-2 rounded-full shrink-0 font-medium transition-all filter-active">Barchasi</button>
                <button data-filter="week" onclick="setDateFilter('week')"
                    class="date-filter-btn bg-slate-800 border border-slate-700 text-slate-300 text-xs px-4 py-2 rounded-full shrink-0 font-medium transition-all">Hafta</button>
                <button data-filter="month" onclick="setDateFilter('month')"
                    class="date-filter-btn bg-slate-800 border border-slate-700 text-slate-300 text-xs px-4 py-2 rounded-full shrink-0 font-medium transition-all">Oy</button>
                <button onclick="openDateRangeModal()"
                    class="bg-slate-700 text-slate-300 text-xs px-3 py-1.5 rounded-full border border-slate-600 flex items-center gap-1 shrink-0 hover:bg-slate-600"><i
                        data-lucide="calendar" class="w-3 h-3"></i> Sana</button>
            </div>

            <div id="trend-container" class="hidden space-y-3">
                <h3 class="text-slate-400 text-xs font-bold uppercase tracking-wider ml-1">Trendlar (O'tgan oyga
                    nisbatan)</h3>
                <div id="trend-list" class="grid grid-cols-2 gap-3"></div>
            </div>

            <div class="glass-panel p-5 rounded-3xl shadow-sm">
                <h3 class="text-slate-200 font-semibold mb-4 flex items-center gap-2 text-sm"><i data-lucide="pie-chart"
                        class="w-4 h-4 text-blue-500"></i> Statistika</h3>
                <div class="h-48 relative flex items-center justify-center"><canvas id="categoryChart"></canvas>
                    <div id="no-data-msg" class="absolute text-slate-500 text-xs hidden">Ma'lumot yo'q</div>
                </div>
            </div>

            <div class="glass-panel p-5 rounded-3xl shadow-sm">
                <h3 class="text-slate-200 font-semibold mb-4 text-sm">Top 5 Operatsiyalar</h3>
                <table class="w-full text-left text-sm">
                    <tbody id="top-transaction-list" class="divide-y divide-slate-700/50"></tbody>
                </table>
            </div>
        </div>

        <div id="view-bot" class="flex flex-col h-full hidden fade-in relative">
            <div
                class="text-center text-xs text-slate-500 py-2 bg-slate-900/50 backdrop-blur-sm absolute top-0 w-full z-10 border-b border-slate-800">
                Yordamchi Bot</div>
            <div class="flex-1 overflow-y-auto p-2 pt-10 pb-32 chat-content" id="chat-messages">
                <div class="msg-wrapper ai fade-in">
                    <div class="msg-bubble ai">Assalomu alaykum! Qaysi operatsiyani bajaramiz?üí∏</div>
                </div>
            </div>

            <div
                class="p-4 bg-slate-800/95 backdrop-blur-xl border-t border-slate-700 relative bottom-[-33px] left-0 right-0 z-20 rounded-t-3xl shadow-[0_-4px_20px_rgba(0,0,0,0.3)]">
                <div id="bot-start-actions">
                    <div class="text-center text-[10px] font-bold text-slate-500 mb-3 tracking-widest">Kirim / Chiqim
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="startBotFlow('income')"
                            class="bg-emerald-500/10 py-3 rounded-2xl border border-emerald-500/20 flex items-center justify-center gap-4 transition-all active:scale-95 group hover:bg-emerald-500/20">
                            <div
                                class="bg-emerald-500 text-white p-2 rounded-full shadow-lg shadow-emerald-500/30 transition-all">
                                <i data-lucide="arrow-down-left" class="w-5 h-5"></i>
                            </div>
                            <span class="text-emerald-400 font-bold">Kirim</span>
                        </button>
                        <button onclick="startBotFlow('expense')"
                            class="flex space-between bg-rose-500/10 p-1 rounded-2xl border border-rose-500/20 items-center justify-center gap-2 transition-all active:scale-95 group hover:bg-rose-500/20">
                            <div
                                class="bg-rose-500 text-white p-2 rounded-full shadow-lg shadow-rose-500/30 transition-all">
                                <i data-lucide="arrow-up-right" class="w-5 h-5"></i>
                            </div>
                            <span class="text-rose-400 font-bold">Chiqim</span>
                        </button>
                    </div>
                </div>

                <div id="bot-input-container" class="hidden flex flex-col gap-3">
                    <div id="receipt-preview-area"
                        class="hidden flex items-center gap-3 bg-slate-700/50 p-2 rounded-xl border border-slate-600">
                        <div class="w-12 h-12 bg-slate-800 rounded-lg overflow-hidden flex-shrink-0"><img
                                id="receipt-img-preview" class="w-full h-full object-cover"></div>
                        <div class="flex-1 text-xs text-emerald-400 font-medium">Chek biriktirildi</div>
                        <button onclick="clearReceipt()" class="p-2 text-rose-400 hover:bg-slate-700 rounded-full"><i
                                data-lucide="trash-2" class="w-4 h-4"></i></button>
                    </div>

                    <div class="flex gap-2 items-center relative">
                        <button onclick="document.getElementById('file-upload').click()"
                            class="p-3 bg-slate-700 rounded-xl text-blue-400 hover:text-white hover:bg-slate-600 transition-colors"><i
                                data-lucide="camera" class="w-5 h-5"></i></button>
                        <input type="file" id="file-upload" accept="image/*" class="hidden"
                            onchange="handleReceiptUpload(event)">
                        <div class="flex-1 relative">
                            <input type="tel" id="bot-input"
                                class="w-full bg-slate-700 text-white rounded-xl pl-4 pr-10 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
                                placeholder="Summani kiriting..." autocomplete="off"
                                onkeydown="if(event.key==='Enter'){submitBotInput();}">
                            <button onclick="cancelBotFlow()"
                                class="absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-rose-400 p-1"><i
                                    data-lucide="x-circle" class="w-5 h-5"></i></button>
                        </div>
                        <button onclick="submitBotInput()"
                            class="bg-blue-600 text-white p-3 rounded-xl shadow-lg shadow-blue-600/30 hover:bg-blue-500 active:scale-95 transition-transform"><i
                                data-lucide="send" class="w-5 h-5"></i></button>
                    </div>
                </div>

                <div id="category-selector" class="hidden pt-4 relative">
                    <div class="flex justify-between items-center mb-3 px-1">
                        <span class="text-slate-400 text-xs font-bold uppercase">Kategoriya tanlang</span>
                        <button onclick="openAddCategoryModal()"
                            class="text-blue-400 text-xs font-bold flex items-center gap-1"><i data-lucide="plus"
                                class="w-3 h-3"></i> Yangi</button>
                    </div>
                    <div class="text-[10px] text-slate-500 mb-2 italic text-center">Tahrirlash uchun ustiga bosib turing
                    </div>
                    <div id="category-grid" class="grid grid-cols-4 gap-2 max-h-48 overflow-y-auto pb-2"></div>
                    <button onclick="cancelBotFlow()" class="absolute -top-2 right-0 p-2 text-slate-500"><i
                            data-lucide="x" class="w-4 h-4"></i></button>
                </div>
            </div>
        </div>
        <div id="view-history" class="hidden fade-in space-y-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-bold text-white">Tarix</h2>
                <button onclick="openExportModal()"
                    class="bg-slate-700 hover:bg-slate-600 text-white px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-2 transition-all border border-slate-600 active:scale-95"><i
                        data-lucide="file-down" class="w-3 h-3"></i> PDF</button>
            </div>
            <div id="history-list" class="space-y-3 pb-24"></div>
            <div id="empty-history" class="hidden flex flex-col items-center justify-center py-10 text-slate-500"><i
                    data-lucide="clipboard-list" class="w-12 h-12 mb-2 opacity-30"></i>
                <p class="text-sm mt-2">Ma'lumot yo'q</p>
            </div>
        </div>
    </main>

    <nav
        class="glass-panel fixed bottom-0 left-0 right-0 rounded-t-2xl flex justify-around pt-2 px-2 z-30 max-w-md h-16 mx-auto shadow-[0_-4px_20px_rgba(0,0,0,0.2)] pb-4">
        <button onclick="switchTab('dashboard')" id="nav-dashboard"
            class="flex flex-col items-center gap-1 w-14 nav-item active"><i data-lucide="layout-dashboard"
                class="w-5 h-5"></i><span class="text-[9px] font-bold">Asosiy</span></button>
        <button onclick="switchTab('bot')" id="nav-bot"
            class="relative -top-6 bg-slate-800 border-4 border-slate-900 w-14 h-14 rounded-full flex items-center justify-center text-slate-400 shadow-lg transition-all"><i
                data-lucide="plus" class="w-6 h-6"></i></button>
        <button onclick="switchTab('history')" id="nav-history"
            class="flex flex-col items-center gap-1 w-14 nav-item"><i data-lucide="history" class="w-5 h-5"></i><span
                class="text-[9px] font-bold">Tarix</span></button>
    </nav>

    <div id="action-sheet" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 hidden flex items-end justify-center"
        onclick="closeActionSheet(event)">
        <div class="bg-slate-800 w-full max-w-md rounded-t-2xl p-5 border-t border-slate-700 slide-up shadow-2xl"
            onclick="event.stopPropagation()">
            <div class="w-12 h-1 bg-slate-600 rounded-full mx-auto mb-6"></div>
            <div id="action-sheet-content" class="space-y-3"></div>
            <button onclick="closeActionSheet(null)"
                class="mt-4 w-full py-3.5 bg-slate-900 rounded-xl text-slate-400 font-bold text-sm">Yopish</button>
        </div>
    </div>

    <div id="cat-context-menu"
        class="fixed z-[60] hidden bg-slate-800 border border-slate-700 rounded-xl shadow-2xl overflow-hidden w-40 scale-in">
        <button onclick="editCatFromMenu()"
            class="w-full text-left px-4 py-3 hover:bg-slate-700 text-blue-400 text-sm font-medium flex items-center gap-2"><i
                data-lucide="edit-2" class="w-4 h-4"></i> Tahrirlash</button>
        <button onclick="deleteCatFromMenu()"
            class="w-full text-left px-4 py-3 hover:bg-slate-700 text-rose-400 text-sm font-medium flex items-center gap-2"><i
                data-lucide="trash-2" class="w-4 h-4"></i> O'chirish</button>
    </div>
    <div id="receipt-modal" class="fixed inset-0 bg-black/95 z-[90] hidden flex items-center justify-center p-2"
        onclick="closeReceiptModal()"><button class="absolute top-4 right-4 p-2 bg-white/10 rounded-full text-white"><i
                data-lucide="x" class="w-6 h-6"></i></button><img id="full-receipt-image"
            class="max-w-full max-h-[85vh] rounded shadow-2xl object-contain"></div>
    <div id="settings-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700 slide-up">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-white">Sozlamalar‚öôÔ∏è</h3><button
                    onclick="closeModal('settings-modal')"><i data-lucide="x" class="text-slate-400"></i></button>
            </div>
            <div class="space-y-3">
                <div class="bg-slate-700 rounded-xl p-1 overflow-hidden mb-4"><button onclick="startPinSetup()"
                        class="w-full p-4 flex items-center justify-between hover:bg-slate-600 transition-colors rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-blue-500/20 rounded-lg text-blue-400"><i data-lucide="lock"
                                    class="w-5 h-5"></i></div>
                            <div>
                                <div class="text-white text-sm font-bold">PIN Kod</div>
                                <div id="pin-status-text" class="text-xs text-slate-400"></div>
                            </div>
                        </div><i data-lucide="chevron-right" class="w-4 h-4 text-slate-500"></i>
                    </button><button id="btn-remove-pin" onclick="removePin()"
                        class="w-full p-4 flex items-center justify-between hover:bg-slate-600 transition-colors rounded-lg border-t border-slate-600 hidden">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-rose-500/20 rounded-lg text-rose-400"><i data-lucide="unlock"
                                    class="w-5 h-5"></i></div>
                            <div class="text-white text-sm font-bold text-rose-400">PINni o'chirish</div>
                        </div>
                    </button>
                    <div class="h-[1px] bg-slate-600 mx-4"></div>
                    <div id="bio-row" class="p-4 flex items-center justify-between hidden">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-purple-500/20 rounded-lg text-purple-400"><i data-lucide="scan-face"
                                    class="w-5 h-5"></i></div>
                            <div class="text-white text-sm font-bold">Face ID / Touch ID</div>
                        </div><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox"
                                id="bio-toggle" class="sr-only peer" onchange="toggleBiometric(this)">
                            <div
                                class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                            </div>
                        </label>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3"><button onclick="exportData()"
                        class="p-4 bg-slate-700 rounded-xl flex flex-col items-center gap-2 hover:bg-slate-600"><i
                            data-lucide="download" class="text-emerald-400"></i><span
                            class="text-xs text-slate-300 font-bold">Yuklash</span></button><button
                        onclick="document.getElementById('import-file').click()"
                        class="p-4 bg-slate-700 rounded-xl flex flex-col items-center gap-2 hover:bg-slate-600"><i
                            data-lucide="upload" class="text-blue-400"></i><span
                            class="text-xs text-slate-300 font-bold">Tiklash</span></button><input type="file"
                        id="import-file" class="hidden" onchange="importData(event)" accept=".json"></div><button
                    onclick="confirmResetData()"
                    class="w-full p-4 bg-rose-900/20 text-rose-400 rounded-xl flex items-center justify-center gap-2 mt-2 hover:bg-rose-900/30"><i
                        data-lucide="trash-2" class="w-4 h-4"></i> Tozalash</button>
            </div>
        </div>
    </div>
    <div id="edit-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-5 w-full max-w-sm border border-slate-700">
            <h3 class="text-lg font-bold text-white mb-4">Tahrirlash</h3>
            <div class="space-y-3"><input type="text" id="edit-category"
                    class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600"><input
                    type="tel" id="edit-amount"
                    class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600"><select
                    id="edit-type"
                    class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600">
                    <option value="income">Kirim (+)</option>
                    <option value="expense">Chiqim (-)</option>
                </select></div>
            <div class="flex gap-3 mt-6"><button onclick="closeModal('edit-modal')"
                    class="flex-1 py-3 bg-slate-700 rounded-xl text-slate-300">Bekor</button><button
                    onclick="saveEdit()"
                    class="flex-1 py-3 bg-blue-600 rounded-xl text-white font-bold">Saqlash</button></div>
        </div>
    </div>
    <div id="delete-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-5 w-full max-w-sm border border-slate-700 text-center">
            <h3 class="text-lg font-bold text-white mb-2">O'chirish</h3>
            <p class="text-slate-400 text-sm mb-6">Ushbu operatsiyani rostdan ham o'chirmoqchimisiz?</p>
            <div class="flex gap-3"><button onclick="closeModal('delete-modal')"
                    class="flex-1 py-3 bg-slate-700 rounded-xl text-slate-300">Bekor</button><button
                    onclick="confirmDelete()"
                    class="flex-1 py-3 bg-rose-600 rounded-xl text-white font-bold">O'chirish</button></div>
        </div>
    </div>
    <div id="add-cat-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700">
            <h3 class="text-lg font-bold text-white mb-4">Yangi Kategoriya</h3><input type="text" id="new-cat-name"
                placeholder="Nomi"
                class="w-full bg-slate-700 rounded-xl p-3 text-white border border-slate-600 mb-4 focus:border-blue-500 outline-none">
            <div class="grid grid-cols-5 gap-2 mb-6" id="icon-selector"></div>
            <div class="flex gap-3"><button onclick="closeModal('add-cat-modal')"
                    class="flex-1 py-3 bg-slate-700 rounded-xl text-slate-300">Bekor</button><button
                    onclick="saveNewCategory()"
                    class="flex-1 py-3 bg-blue-600 rounded-xl text-white font-bold">Saqlash</button></div>
        </div>
    </div>
    <div id="edit-cat-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[75] hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700">
            <h3 class="text-lg font-bold text-white mb-4">Kategoriyani Tahrirlash</h3><input type="text"
                id="edit-cat-name-input"
                class="w-full bg-slate-700 rounded-xl p-3 text-white border border-slate-600 mb-4 outline-none">
            <div class="flex gap-3"><button onclick="closeModal('edit-cat-modal')"
                    class="flex-1 py-3 bg-slate-700 rounded-xl text-slate-300">Bekor</button><button
                    onclick="confirmEditCat()"
                    class="flex-1 py-3 bg-blue-600 rounded-xl text-white font-bold">Saqlash</button></div>
        </div>
    </div>
    <div id="date-range-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white">Maxsus Sana</h3><button
                    onclick="closeModal('date-range-modal')" class="text-slate-400 hover:text-white"><i data-lucide="x"
                        class="w-6 h-6"></i></button>
            </div>
            <div class="space-y-4"><input type="date" id="start-date"
                    class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600"><input
                    type="date" id="end-date"
                    class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600"></div>
            <button onclick="applyDateRange()"
                class="mt-6 w-full bg-blue-600 py-3 rounded-xl text-white font-bold">Qo'llash</button>
        </div>
    </div>
    <div id="export-modal"
        class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[80] hidden flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-sm border border-slate-700 slide-up">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="file-down"
                        class="text-blue-400"></i> PDF Hisobot</h3><button onclick="closeModal('export-modal')"
                    class="text-slate-400 hover:text-white"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div class="space-y-4">
                <div><label class="text-xs text-slate-400 ml-1">Boshlanish sanasi</label><input type="date"
                        id="export-start-date"
                        class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600 mt-1 focus:border-blue-500 transition-colors">
                </div>
                <div><label class="text-xs text-slate-400 ml-1">Tugash sanasi</label><input type="date"
                        id="export-end-date"
                        class="w-full bg-slate-700 rounded-xl p-3 text-white outline-none border border-slate-600 mt-1 focus:border-blue-500 transition-colors">
                </div>
                <div class="bg-slate-700/50 rounded-xl p-3 border border-slate-600">
                    <div class="flex justify-between text-sm mb-1"><span class="text-slate-400">Topildi:</span><span
                            id="export-count" class="text-white font-bold">0 ta</span></div>
                    <div class="flex justify-between text-sm"><span class="text-slate-400">Cheklar:</span><span
                            id="export-receipts" class="text-blue-400 font-bold">0 ta</span></div>
                </div>
            </div>
            <button onclick="generatePDF()"
                class="mt-6 w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 py-3 rounded-xl text-white font-bold shadow-lg shadow-blue-500/30 active:scale-95 transition-all flex items-center justify-center gap-2"><i
                    data-lucide="download" class="w-4 h-4"></i> Yuklash</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>